user.totalMoney += netPnl;
    user.realisedPL += netPnl;
    user.totalEstCharge += totalCharges;
    user.openPositions -= 1;

    if (netPnl > 0) {
      user.totalProfit += parseFloat(netPnl.toFixed(2));
      if (!bestTrade || bestTrade.netpnl < netPnl) {
        user.bestTrade = trade._id;
      }
    } else {
      user.totalLoss += parseFloat(netPnl.toFixed(2));
      if (!worstTrade || worstTrade.netpnl > netPnl) {
        user.worstTrade = trade._id;
      }
    }

    if (grossPnl > 0) {
      const updatedWinRate = ((winRate * totalCompletedTrades) + 1) / (totalCompletedTrades + 1);
      user.winRate = parseFloat((updatedWinRate * 100).toFixed(2)); // make it percentage
    } else {
      const updatedWinRate = ((winRate * totalCompletedTrades) + 0) / (totalCompletedTrades + 1);
      user.winRate = parseFloat((updatedWinRate * 100).toFixed(2));
    }

    user.totalCompletedTrades += 1;